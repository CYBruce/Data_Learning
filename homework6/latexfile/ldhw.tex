% Homework template for Learning from Data
% by Xiangxiang Xu <xiangxiangxu.thu@gmail.com>
% LAST UPDATE: October 8, 2018
\documentclass[a4paper]{article}
\usepackage[T1]{fontenc}
\usepackage{amsmath, amssymb, amsthm}
% amsmath: equation*, amssymb: mathbb, amsthm: proof
\usepackage{moreenum}
\usepackage{mathtools}
\usepackage{url}
\usepackage{enumitem}
\usepackage{bm}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{booktabs} % toprule
\usepackage[mathcal]{eucal}
\usepackage{dsfont}
\usepackage[numbered,framed]{matlab-prettifier}
\input{lddef}

\lstset{
  style              = Matlab-editor,
  captionpos         =b,
  basicstyle         = \mlttfamily,
  escapechar         = ",
  mlshowsectionrules = true,
}
\begin{document}
\courseheader



\newcounter{hwcnt}
\setcounter{hwcnt}{3} % set to the times of Homework

\begin{center}
  \underline{\bf Writing Homework 3}%\thehwcnt} \\
\end{center}
\begin{flushleft}
  TIAN Chenyu\hfill
  \today
\end{flushleft}
\hrule

\vspace{2em}
\setlist[enumerate,1]{label=\thehwcnt.\arabic*.}
\setlist[enumerate,2]{label=(\alph*)}
\setlist[enumerate,3]{label=\roman*.}
\setlist[enumerate,4]{label=\greek*)}

\flushleft
\rule{\textwidth}{1pt}
\begin{itemize}
\item {\bf Acknowledgments: \/} 
  This template takes some materials from course CSE 547/Stat 548 of Washington University: \small{\url{https://courses.cs.washington.edu/courses/cse547/17sp/index.html}}.
\item {\bf Collaborators: \/}
  I finish this homework by myself.
  % \begin{itemize}
  % \item 1.2 (b) was solved with the help from \underline{\hspace{3em}}.
  % \item Discussion with \underline{\hspace{3em}} helped me finishing 1.3.
  % \end{itemize}
\end{itemize}
\rule{\textwidth}{1pt}

\vspace{2em}

% You may use \texttt{enumerate} to generate answers for each question:

% 3.1
\begin{enumerate}
  \setlength{\itemsep}{3\parskip}
\item 
\begin{enumerate}
  \item
  \begin{enumerate}
    \item 
    \begin{equation*}
      \begin{aligned}
        &\underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}-\boldsymbol{\mu}_{j}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}} (\left\|\boldsymbol{x}\right\|^{2} + \frac{1}{\left|C_{j}\right|^{2}}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2} - \frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}))\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} + \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{1}{\left|C_{j}\right|^{2}}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}})\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} + \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}})\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} - \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} (\sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} - \frac{1}{\left|C_{j}\right|} \sum_{\boldsymbol{x}, \boldsymbol{x}^{\prime} \in C_{j}} \boldsymbol{x}^{T} \boldsymbol{x}^{'})\\
      \end{aligned}
    \end{equation*}

    \begin{equation*}
      \begin{aligned}
        &\underset{C}{\arg \min } \sum_{j=1}^{k} \frac{1}{2\left|C_{j}\right|} \sum_{\boldsymbol{x}, \boldsymbol{x}^{\prime} \in C_{j}}\left\|\boldsymbol{x}-\boldsymbol{x}^{\prime}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}} (\left\|\boldsymbol{x}\right\|^{2} + \frac{1}{\left|C_{j}\right|^{2}}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2} - \frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}))\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} + \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{1}{\left|C_{j}\right|^{2}}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}})\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} + \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}})\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} - \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x^{'}}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} (\sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} - \frac{1}{\left|C_{j}\right|} \sum_{\boldsymbol{x}, \boldsymbol{x}^{\prime} \in C_{j}} \boldsymbol{x}^{T} \boldsymbol{x}^{'})\\
      \end{aligned}
    \end{equation*}
    
    
    \item
    \begin{equation*}
      \begin{aligned}
        &\underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}-\boldsymbol{\mu}_{j}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}} (\left\|\boldsymbol{x}\right\|^{2} + \frac{1}{\left|C_{j}\right|^{2}}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x}\right\|^{2} - \frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x}))\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} + \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{1}{\left|C_{j}\right|^{2}}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x})\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} + \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\frac{2}{\left|C_{j}\right|} \boldsymbol{x}^{T} (\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x})\\
        \Rightarrow & \underset{C}{\arg \min } \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2} - \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \max } \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|}\left\|\sum_{\boldsymbol{x^{'}} \in C_{j}} \boldsymbol{x}\right\|^{2} - \sum_{j=1}^{k} \sum_{\boldsymbol{x} \in C_{j}}\left\|\boldsymbol{x}\right\|^{2}\\
        \Rightarrow & \underset{C}{\arg \max } \sum_{j=1}^{k} \frac{1}{\left|C_{j}\right|} \sum_{\boldsymbol{x}, \boldsymbol{x}^{\prime} \in C_{j}} \boldsymbol{x}^{T} \boldsymbol{x}^{'}\\
      \end{aligned}
    \end{equation*}

  \end{enumerate}
  
  
  \item Based on 
  \begin{enumerate}
    \item Since the 
    
    
    \item Based on 
  \end{enumerate}
\end{enumerate}

% 3.2
\item 
\begin{enumerate}
  \item Since the 
  \begin{enumerate}
    \item Since the 
    
    
    \item Based on 
  \end{enumerate}
  
  
  \item Based on 
\end{enumerate}


\begin{equation*}
  \boldsymbol{\Sigma_{1}} = \frac{1}{\sum_{i=1}^{m} \1 (y^{(i)}=1)} \sum_{i=1}^{m}\1 (y^{(i)}=1)\left(\boldsymbol{x}^{(i)}-\boldsymbol{\mu_{1}}\right)\left(\boldsymbol{x}^{(i)}-\boldsymbol{\mu_{1}}\right)^{\mathrm{T}}
\end{equation*}


% 3.3
\item 
\begin{enumerate}
  \item Since the 
  
  \item baskfdjl
  
  \item Based on 
\end{enumerate}


%3.4
\item 


%3.5
\item 
\begin{enumerate}
  \item The original problem is
  \begin{equation*}
    \begin{aligned}
    \begin{array}{cl}{\underset{\boldsymbol{w}, b, \boldsymbol{\xi}}{\operatorname{minimize}}} & {\frac{1}{2}\|\boldsymbol{w}\|_{2}^{2}+C \sum_{i=1}^{l} \xi_{i}} \\ 
    {\text { subject to }} & {\xi_{i} \geq 0, \quad i=1, \ldots, l} \\
    {} & {y_{i}\left(\boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right) \geq 1-\xi_{i}, \quad i=1, \ldots, l}\end{array}
    \end{aligned}
  \end{equation*}
  For the optimal solution, \\
  if $y_{i}\left(\boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right) \geq 1$, because we want to minimize $\sum_{i=1}^{l} \xi_{i}$, $\xi_{i}$ must be 0, which equals to $\ell\left(y_{i}, \boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right)$;\\
  if $y_{i}\left(\boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right) < 1$, because of the constrains, $\xi_{i}$ must be $1-y_{i}\left(\boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right)$, which equals to $\ell\left(y_{i}, \boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right)$.\\
  This means if find the solution of the original problem, the solution of (3) in file *wa2* is found.
  

  \item To prove a convex function
  \begin{equation*}
    \begin{aligned}
      f(\boldsymbol{\omega} ,b) = \frac{1}{2}\|\boldsymbol{w}\|_{2}^{2}+C \sum_{i=1}^{l} \ell\left(y_{i}, \boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right)
    \end{aligned}
  \end{equation*}
  So $\ell(\boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b)$ is a convex function.\\
  The non-negative weighted sum of convex functions is still a convex function. And $C \geq 0$. \\
  Thus the objective function $f(\boldsymbol{\omega} ,b) = \frac{1}{2}\|\boldsymbol{w}\|_{2}^{2}+C \sum_{i=1}^{l} \ell\left(y_{i}, \boldsymbol{w}^{\mathrm{T}} \boldsymbol{x}_{i}+b\right)$ is convex.
\end{enumerate}

\end{enumerate}
  
  % \newpage
  
  % \appendix
  % \section{Source code}
  % \label{sec:a:code}
  % % \lstlistoflistings
  % Source code for plotting Figure \ref{fig:1} is shown as follows.
  % \lstinputlisting{matlabscript.m}
  
\end{document}
%%% Local Variables:
%%% mode: latex
%%% TeX-master: t
%%% End:
